<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lua Obfuscated Code Analyzer</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #e6e6e6;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            padding: 30px 0;
            border-bottom: 1px solid #2d4059;
            margin-bottom: 30px;
        }
        
        h1 {
            color: #00adb5;
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: #eeeeee;
            font-size: 1.2rem;
            opacity: 0.8;
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }
        
        @media (max-width: 1024px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }
        
        .panel {
            background: rgba(30, 30, 46, 0.8);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            border: 1px solid #393e46;
        }
        
        .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #00adb5;
        }
        
        h2 {
            color: #00adb5;
            font-size: 1.8rem;
        }
        
        h3 {
            color: #00adb5;
            font-size: 1.3rem;
            margin-bottom: 15px;
        }
        
        .code-input {
            width: 100%;
            min-height: 400px;
            background: #0f3460;
            color: #e6e6e6;
            border: 2px solid #393e46;
            border-radius: 8px;
            padding: 20px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 14px;
            line-height: 1.5;
            resize: vertical;
            white-space: pre;
            overflow-x: auto;
        }
        
        .code-input:focus {
            outline: none;
            border-color: #00adb5;
            box-shadow: 0 0 0 2px rgba(0, 173, 181, 0.2);
        }
        
        .btn {
            background: linear-gradient(135deg, #00adb5 0%, #0097a7 100%);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn:hover {
            background: linear-gradient(135deg, #0097a7 0%, #00838f 100%);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 173, 181, 0.4);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #ff5722 0%, #d84315 100%);
        }
        
        .btn-danger:hover {
            background: linear-gradient(135deg, #d84315 0%, #bf360c 100%);
            box-shadow: 0 5px 15px rgba(255, 87, 34, 0.4);
        }
        
        .controls {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-top: 20px;
        }
        
        .analysis-output {
            background: #0f3460;
            border-radius: 8px;
            padding: 20px;
            max-height: 500px;
            overflow-y: auto;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 13px;
            line-height: 1.4;
            white-space: pre-wrap;
            word-break: break-all;
        }
        
        .log-entry {
            margin-bottom: 12px;
            padding: 10px;
            border-radius: 5px;
            background: rgba(255, 255, 255, 0.05);
            border-left: 4px solid #00adb5;
        }
        
        .log-entry.warning {
            border-left-color: #ff9800;
            background: rgba(255, 152, 0, 0.1);
        }
        
        .log-entry.danger {
            border-left-color: #f44336;
            background: rgba(244, 67, 54, 0.1);
        }
        
        .log-entry.info {
            border-left-color: #2196f3;
            background: rgba(33, 150, 243, 0.1);
        }
        
        .log-timestamp {
            color: #aaaaaa;
            font-size: 11px;
            margin-bottom: 5px;
        }
        
        .log-message {
            color: #e6e6e6;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .stat-card {
            background: rgba(0, 173, 181, 0.1);
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            border: 1px solid rgba(0, 173, 181, 0.3);
        }
        
        .stat-value {
            font-size: 2.5rem;
            font-weight: bold;
            color: #00adb5;
            margin: 10px 0;
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: #aaaaaa;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .string-list {
            max-height: 300px;
            overflow-y: auto;
            margin-top: 15px;
        }
        
        .string-item {
            background: rgba(255, 255, 255, 0.05);
            padding: 8px 12px;
            margin-bottom: 8px;
            border-radius: 5px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 12px;
            word-break: break-all;
        }
        
        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }
        
        .loading-spinner {
            border: 4px solid rgba(0, 173, 181, 0.3);
            border-top: 4px solid #00adb5;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        footer {
            text-align: center;
            padding: 30px 0;
            margin-top: 50px;
            border-top: 1px solid #2d4059;
            color: #aaaaaa;
            font-size: 0.9rem;
        }
        
        .warning-box {
            background: rgba(255, 152, 0, 0.1);
            border: 1px solid #ff9800;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .danger-box {
            background: rgba(244, 67, 54, 0.1);
            border: 1px solid #f44336;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .function-list {
            margin-top: 15px;
        }
        
        .function-item {
            background: rgba(33, 150, 243, 0.1);
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 5px;
            border-left: 4px solid #2196f3;
        }
        
        .function-name {
            font-weight: bold;
            color: #2196f3;
            margin-bottom: 5px;
        }
        
        .function-details {
            font-size: 12px;
            color: #aaaaaa;
        }
        
        .tab-container {
            margin-top: 20px;
        }
        
        .tabs {
            display: flex;
            border-bottom: 1px solid #393e46;
            margin-bottom: 20px;
        }
        
        .tab {
            padding: 12px 25px;
            background: transparent;
            color: #aaaaaa;
            border: none;
            cursor: pointer;
            font-size: 16px;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
        }
        
        .tab:hover {
            color: #ffffff;
        }
        
        .tab.active {
            color: #00adb5;
            border-bottom: 3px solid #00adb5;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üîç Lua Obfuscated Code Analyzer</h1>
            <p class="subtitle">Environment Logger & Code Dumper ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÇ‡∏Ñ‡πâ‡∏î Lua ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å Obfuscate</p>
        </header>
        
        <div class="warning-box">
            ‚ö†Ô∏è <strong>‡∏Ñ‡∏≥‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô:</strong> ‡∏≠‡∏¢‡πà‡∏≤‡∏£‡∏±‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏£‡∏π‡πâ‡∏à‡∏±‡∏Å‡πÉ‡∏ô production environment! ‡πÇ‡∏Ñ‡πâ‡∏î‡∏ô‡∏µ‡πâ‡∏≠‡∏≤‡∏à‡πÄ‡∏õ‡πá‡∏ô malicious code ‡∏ó‡∏µ‡πà‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏° bypass anti-cheat systems
        </div>
        
        <div class="main-content">
            <div class="panel">
                <div class="panel-header">
                    <h2>Input Code</h2>
                </div>
                <textarea id="codeInput" class="code-input" placeholder="‡∏ß‡∏≤‡∏á‡πÇ‡∏Ñ‡πâ‡∏î Lua ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å obfuscate ‡πÑ‡∏ß‡πâ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà...">
-- ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÇ‡∏Ñ‡πâ‡∏î Lua ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å obfuscate
local _G = _G
local string = string
local table = table
local math = math
local io = io
local os = os
local debug = debug
local loadstring = loadstring
local tonumber = tonumber
local tostring = tostring
local pairs = pairs
local ipairs = ipairs
local type = type
local assert = assert
local error = error
local pcall = pcall
local xpcall = xpcall
local select = select
local rawget = rawget
local rawset = rawset
local setmetatable = setmetatable
local getmetatable = getmetatable
local next = next
local unpack = unpack
local require = require

local a = {}
for i = 1, 10 do
    a[i] = i * 2
end

local b = "SGVsbG8gV29ybGQh" -- Base64 encoded "Hello World!"
local c = "\x48\x65\x6c\x6c\x6f\x20\x57\x6f\x72\x6c\x64\x21" -- Hex encoded

local function d(e)
    return e .. " concatenated"
end

local f = {72, 101, 108, 108, 111, 32, 87, 111, 114, 108, 100, 33}
local g = ""
for i = 1, #f do
    g = g .. string.char(f[i])
end

print("‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå: " .. g)</textarea>
                
                <div class="controls">
                    <button id="analyzeBtn" class="btn">üîç ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÇ‡∏Ñ‡πâ‡∏î</button>
                    <button id="clearBtn" class="btn btn-danger">üóëÔ∏è ‡∏•‡πâ‡∏≤‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
                    <button id="exampleBtn" class="btn">üìã ‡πÇ‡∏´‡∏•‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÇ‡∏Ñ‡πâ‡∏î</button>
                    <button id="deobfuscateBtn" class="btn">üß© ‡∏•‡∏≠‡∏á Deobfuscate</button>
                </div>
                
                <div class="loading" id="loadingIndicator">
                    <div class="loading-spinner"></div>
                    <p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÇ‡∏Ñ‡πâ‡∏î...</p>
                </div>
            </div>
            
            <div class="panel">
                <div class="panel-header">
                    <h2>Analysis Results</h2>
                </div>
                
                <div class="tab-container">
                    <div class="tabs">
                        <button class="tab active" data-tab="analysis">üìä Analysis</button>
                        <button class="tab" data-tab="strings">üìù Strings</button>
                        <button class="tab" data-tab="functions">‚öôÔ∏è Functions</button>
                        <button class="tab" data-tab="logs">üìã Execution Logs</button>
                    </div>
                    
                    <div id="analysisTab" class="tab-content active">
                        <h3>‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå</h3>
                        <div id="analysisOutput" class="analysis-output">
                            ‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÇ‡∏Ñ‡πâ‡∏î...
                        </div>
                        
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-label">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡πÇ‡∏Ñ‡πâ‡∏î</div>
                                <div id="codeLength" class="stat-value">0</div>
                                <div class="stat-label">‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-label">‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ã‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô</div>
                                <div id="complexityLevel" class="stat-value">-</div>
                                <div class="stat-label">1-10</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-label">‡∏û‡∏ö Suspicious Patterns</div>
                                <div id="suspiciousCount" class="stat-value">0</div>
                                <div class="stat-label">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-label">Functions ‡∏ó‡∏µ‡πà‡∏û‡∏ö</div>
                                <div id="functionCount" class="stat-value">0</div>
                                <div class="stat-label">‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô</div>
                            </div>
                        </div>
                    </div>
                    
                    <div id="stringsTab" class="tab-content">
                        <h3>Strings ‡∏ó‡∏µ‡πà‡∏û‡∏ö‡πÉ‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î</h3>
                        <div id="stringsList" class="string-list">
                            ‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÇ‡∏Ñ‡πâ‡∏î...
                        </div>
                    </div>
                    
                    <div id="functionsTab" class="tab-content">
                        <h3>Functions ‡∏ó‡∏µ‡πà‡∏û‡∏ö</h3>
                        <div id="functionsList" class="function-list">
                            ‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÇ‡∏Ñ‡πâ‡∏î...
                        </div>
                    </div>
                    
                    <div id="logsTab" class="tab-content">
                        <h3>Execution Logs ‡∏à‡∏≥‡∏•‡∏≠‡∏á</h3>
                        <div id="executionLogs" class="analysis-output">
                            <div class="log-entry info">
                                <div class="log-timestamp">[SYSTEM] Ready to analyze Lua code</div>
                                <div class="log-message">‡∏£‡∏∞‡∏ö‡∏ö‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ß‡∏≤‡∏á‡πÇ‡∏Ñ‡πâ‡∏î Lua ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="panel">
            <div class="panel-header">
                <h2>Detection & Alerts</h2>
            </div>
            
            <div id="detectionAlerts">
                <div class="log-entry info">
                    <div class="log-timestamp">[INFO] Awaiting analysis</div>
                    <div class="log-message">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö threats ‡πÉ‡∏î‡πÜ ‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÇ‡∏Ñ‡πâ‡∏î</div>
                </div>
            </div>
            
            <h3 style="margin-top: 25px;">Known Obfuscation Patterns</h3>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-label">Base64 Encoding</div>
                    <div id="base64Detected" class="stat-value">‡πÑ‡∏°‡πà‡∏û‡∏ö</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Hex Encoding</div>
                    <div id="hexDetected" class="stat-value">‡πÑ‡∏°‡πà‡∏û‡∏ö</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Char Code Obfuscation</div>
                    <div id="charCodeDetected" class="stat-value">‡πÑ‡∏°‡πà‡∏û‡∏ö</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">String Concatenation</div>
                    <div id="concatDetected" class="stat-value">‡πÑ‡∏°‡πà‡∏û‡∏ö</div>
                </div>
            </div>
        </div>
        
        <div class="danger-box">
            ‚ö†Ô∏è <strong>Disclaimer:</strong> ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡πÑ‡∏ß‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡∏à‡∏±‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô ‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£ bypass ‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡πÉ‡∏î‡πÜ ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏ô‡∏µ‡πâ‡∏Å‡∏±‡∏ö‡πÇ‡∏Ñ‡πâ‡∏î‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡∏≠‡∏≤‡∏à‡∏ú‡∏¥‡∏î‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢
        </div>
    </div>
    
    <footer>
        <p>Lua Obfuscated Code Analyzer | ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡∏à‡∏±‡∏¢‡∏î‡πâ‡∏≤‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ | Version 1.0.0</p>
        <p style="margin-top: 10px; font-size: 0.8rem; opacity: 0.7;">
            ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏ô‡∏µ‡πâ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Å‡∏≤‡∏£ obfuscate ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ‡πÄ‡∏ä‡πà‡∏ô Base64, Hex encoding, string splitting, ‡πÅ‡∏•‡∏∞ malicious patterns
        </p>
    </footer>
</div>

<script>
    // DOM Elements
    const codeInput = document.getElementById('codeInput');
    const analyzeBtn = document.getElementById('analyzeBtn');
    const clearBtn = document.getElementById('clearBtn');
    const exampleBtn = document.getElementById('exampleBtn');
    const deobfuscateBtn = document.getElementById('deobfuscateBtn');
    const loadingIndicator = document.getElementById('loadingIndicator');
    const analysisOutput = document.getElementById('analysisOutput');
    const stringsList = document.getElementById('stringsList');
    const functionsList = document.getElementById('functionsList');
    const executionLogs = document.getElementById('executionLogs');
    const detectionAlerts = document.getElementById('detectionAlerts');
    const tabs = document.querySelectorAll('.tab');
    const tabContents = document.querySelectorAll('.tab-content');
    
    // Stats elements
    const codeLengthEl = document.getElementById('codeLength');
    const complexityLevelEl = document.getElementById('complexityLevel');
    const suspiciousCountEl = document.getElementById('suspiciousCount');
    const functionCountEl = document.getElementById('functionCount');
    const base64DetectedEl = document.getElementById('base64Detected');
    const hexDetectedEl = document.getElementById('hexDetected');
    const charCodeDetectedEl = document.getElementById('charCodeDetected');
    const concatDetectedEl = document.getElementById('concatDetected');
    
    // Example Lua obfuscated code
    const exampleCode = `-- ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÇ‡∏Ñ‡πâ‡∏î Lua ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å obfuscate ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏´‡∏ô‡∏±‡∏Å
local _={}
for __=1,10 do _[__]=__*2 end
local __="SGVsbG8gV29ybGQh"
local ___="\\x48\\x65\\x6c\\x6c\\x6f\\x20\\x57\\x6f\\x72\\x6c\\x64\\x21"
local ____=function(_____)return _____.." [OBFUSCATED]" end
local ______={72,101,108,108,111,32,87,111,114,108,100,33}
local _______=""
for ________=1,#______ do
    _______=_______..string.char(______[________])
end

-- ‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡πà‡∏≤‡∏™‡∏á‡∏™‡∏±‡∏¢
local _____________=loadstring("print('Suspicious loadstring call')")
if _____________ then pcall(_____________) end

-- Base64 decode attempt
local ______________="QmFzZTY0IGVuY29kZWQgZGF0YQ=="
local ________________=function(_________________)
    return _________________:gsub('.', function(__________________) 
        return string.char(__________________:byte(1) + 1) 
    end)
end

print("‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ó‡∏µ‡πà‡∏ã‡πà‡∏≠‡∏ô‡∏≠‡∏¢‡∏π‡πà: " .. ________________(______________))`;
    
    // Tab switching
    tabs.forEach(tab => {
        tab.addEventListener('click', () => {
            const tabId = tab.getAttribute('data-tab');
            
            // Update active tab
            tabs.forEach(t => t.classList.remove('active'));
            tab.classList.add('active');
            
            // Show corresponding content
            tabContents.forEach(content => {
                content.classList.remove('active');
                if (content.id === tabId + 'Tab') {
                    content.classList.add('active');
                }
            });
        });
    });
    
    // Load example code
    exampleBtn.addEventListener('click', () => {
        codeInput.value = exampleCode;
        addLog('‡πÇ‡∏´‡∏•‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÇ‡∏Ñ‡πâ‡∏î‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'info');
    });
    
    // Clear all
    clearBtn.addEventListener('click', () => {
        codeInput.value = '';
        analysisOutput.textContent = '‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÇ‡∏Ñ‡πâ‡∏î...';
        stringsList.innerHTML = '‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÇ‡∏Ñ‡πâ‡∏î...';
        functionsList.innerHTML = '‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÇ‡∏Ñ‡πâ‡∏î...';
        executionLogs.innerHTML = '<div class="log-entry info"><div class="log-timestamp">[SYSTEM] Cleared</div><div class="log-message">‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß</div></div>';
        detectionAlerts.innerHTML = '<div class="log-entry info"><div class="log-timestamp">[INFO] Awaiting analysis</div><div class="log-message">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö threats ‡πÉ‡∏î‡πÜ ‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÇ‡∏Ñ‡πâ‡∏î</div></div>';
        
        // Reset stats
        codeLengthEl.textContent = '0';
        complexityLevelEl.textContent = '-';
        suspiciousCountEl.textContent = '0';
        functionCountEl.textContent = '0';
        base64DetectedEl.textContent = '‡πÑ‡∏°‡πà‡∏û‡∏ö';
        hexDetectedEl.textContent = '‡πÑ‡∏°‡πà‡∏û‡∏ö';
        charCodeDetectedEl.textContent = '‡πÑ‡∏°‡πà‡∏û‡∏ö';
        concatDetectedEl.textContent = '‡πÑ‡∏°‡πà‡∏û‡∏ö';
        
        addLog('‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢', 'info');
    });
    
    // Analyze code
    analyzeBtn.addEventListener('click', () => {
        const code = codeInput.value.trim();
        if (!code) {
            alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡πÇ‡∏Ñ‡πâ‡∏î Lua ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå');
            return;
        }
        
        startAnalysis(code);
    });
    
    // Deobfuscate attempt
    deobfuscateBtn.addEventListener('click', () => {
        const code = codeInput.value.trim();
        if (!code) {
            alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡πÇ‡∏Ñ‡πâ‡∏î Lua ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå');
            return;
        }
        
        attemptDeobfuscation(code);
    });
    
    // Add log entry
    function addLog(message, type = 'info') {
        const timestamp = new Date().toLocaleTimeString();
        const logEntry = document.createElement('div');
        logEntry.className = `log-entry ${type}`;
        logEntry.innerHTML = `
            <div class="log-timestamp">[${timestamp}] ${type.toUpperCase()}</div>
            <div class="log-message">${message}</div>
        `;
        executionLogs.prepend(logEntry);
    }
    
    // Start analysis
    function startAnalysis(code) {
        loadingIndicator.style.display = 'block';
        analysisOutput.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå...';
        addLog('‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÇ‡∏Ñ‡πâ‡∏î', 'info');
        
        // Simulate analysis delay
        setTimeout(() => {
            analyzeCode(code);
            loadingIndicator.style.display = 'none';
        }, 800);
    }
    
    // Main analysis function
    function analyzeCode(code) {
        // Reset detection alerts
        detectionAlerts.innerHTML = '';
        
        // Basic code stats
        const codeLength = code.length;
        const lines = code.split('\n').length;
        
        codeLengthEl.textContent = codeLength.toLocaleString();
        
        // Detection patterns
        let suspiciousCount = 0;
        const detections = [];
        
        // Check for Base64 patterns
        const base64Pattern = /[A-Za-z0-9+/]{20,}={0,2}/g;
        const base64Matches = code.match(base64Pattern);
        if (base64Matches && base64Matches.length > 0) {
            base64DetectedEl.textContent = `‡∏û‡∏ö (${base64Matches.length})`;
            detections.push({
                type: 'warning',
                message: `‡∏û‡∏ö Base64 encoded strings: ${base64Matches.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£`
            });
            suspiciousCount++;
        }
        
        // Check for hex patterns
        const hexPattern = /(?:\\x[0-9a-fA-F]{2}){4,}/g;
        const hexMatches = code.match(hexPattern);
        if (hexMatches && hexMatches.length > 0) {
            hexDetectedEl.textContent = `‡∏û‡∏ö (${hexMatches.length})`;
            detections.push({
                type: 'warning',
                message: `‡∏û‡∏ö Hex encoded sequences: ${hexMatches.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£`
            });
            suspiciousCount++;
        }
        
        // Check for char code patterns
        const charCodePattern = /string\.char\([^)]+\)|char\([^)]+\)|{[0-9,\s]+}/g;
        const charCodeMatches = code.match(charCodePattern);
        if (charCodeMatches && charCodeMatches.length > 0) {
            charCodeDetectedEl.textContent = `‡∏û‡∏ö (${charCodeMatches.length})`;
            detections.push({
                type: 'warning',
                message: `‡∏û‡∏ö Char code obfuscation: ${charCodeMatches.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£`
            });
            suspiciousCount++;
        }
        
        // Check for string concatenation
        const concatPattern = /\.\./g;
        const concatMatches = code.match(concatPattern);
        if (concatMatches && concatMatches.length > 5) {
            concatDetectedEl.textContent = `‡∏û‡∏ö (${concatMatches.length})`;
            detections.push({
                type: 'info',
                message: `‡∏û‡∏ö String concatenation operations: ${concatMatches.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£`
            });
        }
        
        // Check for suspicious functions
        const suspiciousFunctions = ['loadstring', 'load', 'getfenv', 'setfenv', 'debug', 'io\.', 'os\.'];
        let foundSuspiciousFuncs = [];
        
        suspiciousFunctions.forEach(func => {
            const pattern = new RegExp(func, 'g');
            const matches = code.match(pattern);
            if (matches) {
                foundSuspiciousFuncs.push(`${func} (${matches.length}x)`);
            }
        });
        
        if (foundSuspiciousFuncs.length > 0) {
            detections.push({
                type: 'danger',
                message: `‡∏û‡∏ö Suspicious functions: ${foundSuspiciousFuncs.join(', ')}`
            });
            suspiciousCount += foundSuspiciousFuncs.length;
        }
        
        // Check for encoded strings
        const stringPattern = /["']([^"']{20,})["']/g;
        const strings = [];
        let match;
        while ((match = stringPattern.exec(code)) !== null) {
            strings.push(match[1]);
        }
        
        // Extract function definitions
        const functionPattern = /function\s+([a-zA-Z_][a-zA-Z0-9_]*)|local\s+([a-zA-Z_][a-zA-Z0-9_]*)\s*=/g;
        const functions = [];
        while ((match = functionPattern.exec(code)) !== null) {
            const funcName = match[1] || match[2];
            if (funcName && !functions.includes(funcName)) {
                functions.push(funcName);
            }
        }
        
        // Calculate complexity level (simple heuristic)
        let complexity = 1;
        if (codeLength > 1000) complexity++;
        if (lines > 50) complexity++;
        if (base64Matches) complexity += base64Matches.length > 3 ? 2 : 1;
        if (hexMatches) complexity += hexMatches.length > 3 ? 2 : 1;
        if (foundSuspiciousFuncs.length > 0) complexity += 2;
        if (strings.length > 10) complexity++;
        
        complexity = Math.min(complexity, 10);
        
        // Update UI
        complexityLevelEl.textContent = complexity;
        suspiciousCountEl.textContent = suspiciousCount;
        functionCountEl.textContent = functions.length;
        
        // Display strings
        if (strings.length > 0) {
            stringsList.innerHTML = '';
            strings.slice(0, 50).forEach(str => {
                const div = document.createElement('div');
                div.className = 'string-item';
                div.textContent = str.length > 100 ? str.substring(0, 100) + '...' : str;
                stringsList.appendChild(div);
            });
            
            if (strings.length > 50) {
                const more = document.createElement('div');
                more.className = 'string-item info';
                more.textContent = `... ‡πÅ‡∏•‡∏∞‡∏≠‡∏µ‡∏Å ${strings.length - 50} strings`;
                stringsList.appendChild(more);
            }
        } else {
            stringsList.textContent = '‡πÑ‡∏°‡πà‡∏û‡∏ö strings ‡∏ó‡∏µ‡πà‡∏ô‡πà‡∏≤‡∏™‡∏ô‡πÉ‡∏à';
        }
        
        // Display functions
        if (functions.length > 0) {
            functionsList.innerHTML = '';
            functions.forEach(func => {
                const div = document.createElement('div');
                div.className = 'function-item';
                div.innerHTML = `
                    <div class="function-name">${func}</div>
                    <div class="function-details">‡∏ï‡∏£‡∏ß‡∏à‡∏û‡∏ö‡πÉ‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î</div>
                `;
                functionsList.appendChild(div);
            });
        } else {
            functionsList.textContent = '‡πÑ‡∏°‡πà‡∏û‡∏ö function definitions ‡∏ó‡∏µ‡πà‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô';
        }
        
        // Display detections
        detections.forEach(detection => {
            const alert = document.createElement('div');
            alert.className = `log-entry ${detection.type}`;
            alert.innerHTML = `
                <div class="log-timestamp">[DETECTION]</div>
                <div class="log-message">${detection.message}</div>
            `;
            detectionAlerts.appendChild(alert);
        });
        
        if (detections.length === 0) {
            detectionAlerts.innerHTML = '<div class="log-entry info"><div class="log-timestamp">[INFO] No threats detected</div><div class="log-message">‡πÑ‡∏°‡πà‡∏û‡∏ö threats ‡∏ó‡∏µ‡πà‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô‡πÉ‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î‡∏ô‡∏µ‡πâ</div></div>';
        }
        
        // Generate analysis report
        let report = `===== LUA CODE ANALYSIS REPORT =====\n\n`;
        report += `Code Length: ${codeLength} characters\n`;
        report += `Lines: ${lines}\n`;
        report += `Complexity Level: ${complexity}/10\n`;
        report += `Suspicious Patterns: ${suspiciousCount}\n`;
        report += `Functions Found: ${functions.length}\n\n`;
        
        report += `===== DETECTED PATTERNS =====\n`;
        if (base64Matches) report += `Base64 Strings: ${base64Matches.length}\n`;
        if (hexMatches) report += `Hex Sequences: ${hexMatches.length}\n`;
        if (charCodeMatches) report += `Char Code Obfuscation: ${charCodeMatches.length}\n`;
        if (foundSuspiciousFuncs.length > 0) report += `Suspicious Functions: ${foundSuspiciousFuncs.join(', ')}\n`;
        
        report += `\n===== RECOMMENDATIONS =====\n`;
        if (suspiciousCount > 3) {
            report += `‚ö†Ô∏è  HIGH RISK: ‡πÇ‡∏Ñ‡πâ‡∏î‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏ô‡πà‡∏≤‡∏™‡∏á‡∏™‡∏±‡∏¢‡∏°‡∏≤‡∏Å ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏£‡∏±‡∏ô‡πÉ‡∏ô production environment\n`;
        } else if (suspiciousCount > 0) {
            report += `‚ö†Ô∏è  MEDIUM RISK: ‡∏û‡∏ö patterns ‡∏ö‡∏≤‡∏á‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏ô‡πà‡∏≤‡∏™‡∏á‡∏™‡∏±‡∏¢ ‡∏Ñ‡∏ß‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°\n`;
        } else {
            report += `‚úÖ  LOW RISK: ‡πÑ‡∏°‡πà‡∏û‡∏ö patterns ‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô\n`;
        }
        
        if (foundSuspiciousFuncs.length > 0) {
            report += `\nüö® ‡∏û‡∏ö functions ‡∏ó‡∏µ‡πà‡∏≠‡∏≤‡∏à‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢: ${foundSuspiciousFuncs.join(', ')}\n`;
            report += `Functions ‡πÄ‡∏´‡∏•‡πà‡∏≤‡∏ô‡∏µ‡πâ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£ bypass security ‡∏´‡∏£‡∏∑‡∏≠ execute arbitrary code ‡πÑ‡∏î‡πâ\n`;
        }
        
        analysisOutput.textContent = report;
        addLog('‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô', 'info');
    }
    
    // Attempt deobfuscation
    function attemptDeobfuscation(code) {
        addLog('‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏£‡∏∞‡∏ö‡∏ß‡∏ô‡∏Å‡∏≤‡∏£ deobfuscate', 'info');
        
        let deobfuscated = code;
        
        // Try to decode simple char code arrays
        const charCodeArrayPattern = /{([0-9,\s]+)}/g;
        const arrays = [];
        let match;
        
        while ((match = charCodeArrayPattern.exec(code)) !== null) {
            arrays.push(match[1]);
        }
        
        if (arrays.length > 0) {
            addLog(`‡∏û‡∏ö char code arrays: ${arrays.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£`, 'info');
            
            arrays.forEach((arr, index) => {
                try {
                    const numbers = arr.split(',').map(num => parseInt(num.trim()));
                    const decoded = numbers.map(n => String.fromCharCode(n)).join('');
                    addLog(`Array ${index + 1}: "${decoded.substring(0, 50)}${decoded.length > 50 ? '...' : ''}"`, 'info');
                } catch (e) {
                    // Ignore errors
                }
            });
        }
        
        // Check for simple string concatenation
        const concatRegex = /(["'])([^"']*)\1\s*\.\.\s*(["'])([^"']*)\3/g;
        const concats = [];
        while ((match = concatRegex.exec(code)) !== null) {
            concats.push({
                full: match[0],
                part1: match[2],
                part2: match[4]
            });
        }
        
        if (concats.length > 0) {
            addLog(`‡∏û‡∏ö string concatenations: ${concats.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£`, 'info');
        }
        
        // Simple base64 detection
        const base64Regex = /["']([A-Za-z0-9+/]{20,}={0,2})["']/g;
        const base64Strings = [];
        while ((match = base64Regex.exec(code)) !== null) {
            base64Strings.push(match[1]);
        }
        
        if (base64Strings.length > 0) {
            addLog(`‡∏û‡∏ö strings ‡∏ó‡∏µ‡πà‡∏≠‡∏≤‡∏à‡πÄ‡∏õ‡πá‡∏ô Base64: ${base64Strings.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£`, 'warning');
            
            // Try to decode first base64 string
            if (base64Strings[0]) {
                try {
                    const decoded = atob(base64Strings[0]);
                    addLog(`Base64 decode ‡∏û‡∏ö: "${decoded.substring(0, 100)}${decoded.length > 100 ? '...' : ''}"`, 'info');
                } catch (e) {
                    addLog(`‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ decode Base64 string ‡πÑ‡∏î‡πâ`, 'warning');
                }
            }
        }
        
        analysisOutput.textContent = `===== DECOBFUSCATION ATTEMPT =====\n\n`;
        analysisOutput.textContent += `‡∏û‡∏ö Char Code Arrays: ${arrays.length}\n`;
        analysisOutput.textContent += `‡∏û‡∏ö String Concatenations: ${concats.length}\n`;
        analysisOutput.textContent += `‡∏û‡∏ö Base64 Strings: ${base64Strings.length}\n\n`;
        
        analysisOutput.textContent += `‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: ‡∏ô‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô\n`;
        analysisOutput.textContent += `‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£ deobfuscate ‡πÅ‡∏ö‡∏ö‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πåÂèØËÉΩÈúÄË¶Å manual analysis\n`;
        
        addLog('‡∏Å‡∏£‡∏∞‡∏ö‡∏ß‡∏ô‡∏Å‡∏≤‡∏£ deobfuscate ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô', 'info');
    }
    
    // Initialize
    addLog('‡∏£‡∏∞‡∏ö‡∏ö‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô', 'info');
    
    // Auto-resize textarea
    codeInput.addEventListener('input', function() {
        this.style.height = 'auto';
        this.style.height = (this.scrollHeight) + 'px';
    });
</script>
</body>
</html>